---
header-includes:
  - \include{../macros.tex}
---

# CS 427 Homework 13

## Robert Detjens

---

## Question 1

> Show that given an RSA modulus $N$ and $\Phi(N)$, it is possible to factor $N$ easily.
>
> > Hint: You have two equations (involving $N$ and $\Phi(N)$) and two unknowns ($p$ and $q$).
>
> Write a `sage` function that takes as input an RSA modulus $N$ and $\Phi(N)$ and factors $N$. Use it to factor the
> following 2048-bit RSA modulus. Note: take care that there are no precision issues in how you solve the problem (the
> answers should always be integers!); double-check your factorization!

```
  N = 982596486168164533679068138587450785169755353624059289415533430269
      902156543301980948452346231423154225707198230814993348325199962226
      568104628565333075845055110102001513777733822186085910101000971046
      266247429174698114691926560611342709382763139596083197537103114770
      536908672391590105944592251557906143423217780862508367523890586749
      066935355289953519893896713070059149756252671523659055578969907046
      141090712181640128224480409352033671783234281312447922211039322683
      639827785375953048086752423328929034805397916713370525669627143719
      501631537708814980908413840526128966499935897121680247985318025315
      384432533966964970611
phi = 982596486168164533679068138587450785169755353624059289415533430269
      902156543301980948452346231423154225707198230814993348325199962226
      568104628565333075845055110102001513777733822186085910101000971046
      266247429174698114691926560611342709382763139596083197537103114770
      536908672391590105944592251557906143423217666446743565540188952461
      774011877174719813758416590943788767917002449297145315334499665659
      491594110638940233773984185828839341218908554340067876754338082938
      369269776256338912315578202866956834376910088314604816006821137212
      198305050783058433842923026299763443143048326098093860653721449505
      866756049375323695112
```

Sage solver:

```py
def rsa_factor(n, phi):
  p, q = var('p q')
  solves = solve([N == p*q, phi == (p - 1)*(q - 1)], p, q)
  return solves[0] # solve() returns two solves [p, q] and [q, p], either works
```

Factors:

```
p = 93524195713675969769392792891804134476995933511802171872806533613894
    12531812702891792282763505995136608679026507582290903916195465065737
    14513994049240833526816235957699648688337327410429196529474184107065
    91924279351175758639818474602871913428335603560184851762535428165892
    37713501814110266911435430483265167

q = 10506334523061610465734801363429770178600654212894190908310118588883
    28139819275415784491038859906064060912154239886412322904143688606612
    35234905516208831410002395649542617648887800946357680235133745987328
    10651723487088893143934463946546935572265725387034703818063402820699
    7149618094761699250765049161158010333
```

\pagebreak

## Question 2

> Bob and Charlie are such good friends that their RSA public keys have the same $N$ value, although they have different
> $e$-values. Bob’s public key is $(N, e_1)$ and Charlie’s is $(N, e_2)$. Furthermore, $gcd(e_1, e_2) = 1$.
>
> Alice encrypts the same plaintext $m$ for both Bob and Charlie, resulting in $c_1 = m^{e_1} \% N$ and $c_2 = m^{e_2}
> \% N$. Recover $m$ and explain how you did it.
>
> > Hint: Think about Bezout's theorem with respect to $e_1$ and $e_2$.

```
 N = 175522424866121335860870164240860888538031691865491515843268983487
     299607125634825022514712320292483533326428278548679592406322961711
     606826938772861598553559141052955020750715015721922886376758984638
     914203656874899315406302255423076258945463771723803686925312742966
     638265014461328178930066846441760624320732587018230566618216263839
     906183642270047063992914424590457586637109899570533391454457749085
     331143750829884558202556531678780281483197527122194455630744450551
     855222813362275362235944401133760295625086133153541472103122653348
     580745251946819781348530358826077038786192368300086024921087810333
     1943187617555708207359
e1 = 8191
e2 = 131071
c1 = 109897045495142149667850154859013687623006358533579263976800883937
     141362479988391078010844864263194418288306041979220801492846142617
     352477221769609497152549702370227146072114791351442121206877347800
     263259083691041796864302773781409917040711427815628728217952488723
     273971496956790258833196503927908349597394402347154087674754874515
     635964940388705055697754828751740832253097173386979469945037248903
     103195867348811784523011856608602810430133372795285222455720262520
     997477267682454311230488009382307739921102422743073090796816126011
     317418469019945636145794298332322363404524120499868242206633651213
     7572689820466704426069
c2 = 779914122375327168446944321495539646147013727011582646915022183585
     863667774496659134137922953931276041515044439317549838056903393580
     970732054914254349841351440459044660032661030706768561758961303978
     112008624013762668057871018265348823544279449241865906835207121751
     261186926432194729921431216020744388482805088132567108652486138397
     062505215815742718794297370491421564214971665726061492645780239853
     300415696312577861493679531510284127374135497623050504401385011998
     780891938388264218719084702143431349408044167784514258854459143125
     653263844164576330828292595850976078158402567790988321423405416076
     833506075521484284358
```

\begin{minipage}{0.3\textwidth}
  \begin{align*}
    m &\equiv_N m^1 \\
      &\equiv_N m^{Ae_1 + Be_2} \\
      &\equiv_N m^{Ae_1}m^{Be_2} \\
      &\equiv_N (m^{e_1})^A(m^{e_2})^B \\
      &\equiv_N (c_1)^A(c_2)^B
  \end{align*}
\end{minipage}
\begin{minipage}{0.5\textwidth}
  Bezout's Theorem states that if $ax + bn = 1$, $a$ and $x$ are multiplicative inverses mod $n$. These inverses will cancel out and allow the recovery of $m$ from the two ciphertexts.

  $A$ and $B$ can be efficiently found via a modified Euclid's algorithm, e.g. in Sage as $\texttt{xgcd(e1, e2)}$.
\end{minipage}


```py
>>> _, A, B = xgcd(e1, e2)
>>> c1^A * c2^B % N
1223334444555556666667777777888888889999999990000000000
```
